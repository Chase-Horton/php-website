    /*  __      __          ___                                          __             
       /\ \  __/\ \        /\_ \                                        /\ \__          
       \ \ \/\ \ \ \     __\//\ \     ___    ___     ___ ___      __    \ \ ,_\   ___   
        \ \ \ \ \ \ \  /'__`\\ \ \   /'___\ / __`\ /' __` __`\  /'__`\   \ \ \/  / __`\ 
         \ \ \_/ \_\ \/\  __/ \_\ \_/\ \__//\ \L\ \/\ \/\ \/\ \/\  __/    \ \ \_/\ \L\ \
          \ `\___x___/\ \____\/\____\ \____\ \____/\ \_\ \_\ \_\ \____\    \ \__\ \____/
           '\/__//__/  \/____/\/____/\/____/\/___/  \/_/\/_/\/_/\/____/     \/__/\/___/ 
                                                                                        
                                                                                        
                                              ___                                       
                                             /\_ \    __                                
         ___ ___   __  __        ___     ___ \//\ \  /\_\    ___      __                
       /' __` __`\/\ \/\ \      / __`\ /' _ `\ \ \ \ \/\ \ /' _ `\  /'__`\              
       /\ \/\ \/\ \ \ \_\ \    /\ \L\ \/\ \/\ \ \_\ \_\ \ \/\ \/\ \/\  __/              
       \ \_\ \_\ \_\/`____ \   \ \____/\ \_\ \_\/\____\\ \_\ \_\ \_\ \____\             
        \/_/\/_/\/_/`/___/> \   \/___/  \/_/\/_/\/____/ \/_/\/_/\/_/\/____/             
                       /\___/                                                           
                       \/__/                                                            
        __                                                   ___                        
       /\ \__                           __                  /\_ \                       
       \ \ ,_\    __   _ __    ___ ___ /\_\    ___      __  \//\ \                      
        \ \ \/  /'__`\/\`'__\/' __` __`\/\ \ /' _ `\  /'__`\  \ \ \                     
         \ \ \_/\  __/\ \ \/ /\ \/\ \/\ \ \ \/\ \/\ \/\ \L\.\_ \_\ \_                   
          \ \__\ \____\\ \_\ \ \_\ \_\ \_\ \_\ \_\ \_\ \__/.\_\/\____\                  
           \/__/\/____/ \/_/  \/_/\/_/\/_/\/_/\/_/\/_/\/__/\/_/\/____/                  
                                                                                         */
let x = `oooooo   oooooo     oooo           oooo                                                  \n \`888.    \`888.     .8'            \`888                                                  \n  \`888.   .8888.   .8'    .ooooo.   888   .ooooo.   .ooooo.  ooo. .oo.  .oo.    .ooooo.  \n   \`888  .8'\`888. .8'    d88' \`88b  888  d88' \`"Y8 d88' \`88b \`888P"Y88bP"Y88b  d88' \`88b \n    \`888.8'  \`888.8'     888ooo888  888  888       888   888  888   888   888  888ooo888 \n     \`888'    \`888'      888    .o  888  888   .o8 888   888  888   888   888  888    .o \n      \`8'      \`8'       \`Y8bod8P' o888o \`Y8bod8P' \`Y8bod8P' o888o o888o o888o \`Y8bod8P' \n                                                                                         \n                                                                                         \n                                                                                         \n    .                                              \n  .o8                                              \n.o888oo  .ooooo.     ooo. .oo.  .oo.   oooo    ooo \n  888   d88' \`88b    \`888P"Y88bP"Y88b   \`88.  .8'  \n  888   888   888     888   888   888    \`88..8'   \n  888 . 888   888     888   888   888     \`888'    \n  "888" \`Y8bod8P'    o888o o888o o888o     .8'     \n                                       .o..P'      \n                                       \`Y8P'       \n                                                   \n                      oooo   o8o                               .                                         o8o                        oooo  \n                      \`888   \`"'                             .o8                                         \`"'                        \`888  \n .ooooo.  ooo. .oo.    888  oooo  ooo. .oo.    .ooooo.     .o888oo  .ooooo.  oooo d8b ooo. .oo.  .oo.   oooo  ooo. .oo.    .oooo.    888  \nd88' \`88b \`888P"Y88b   888  \`888  \`888P"Y88b  d88' \`88b      888   d88' \`88b \`888""8P \`888P"Y88bP"Y88b  \`888  \`888P"Y88b  \`P  )88b   888  \n888   888  888   888   888   888   888   888  888ooo888      888   888ooo888  888      888   888   888   888   888   888   .oP"888   888  \n888   888  888   888   888   888   888   888  888    .o      888 . 888    .o  888      888   888   888   888   888   888  d8(  888   888  \n\`Y8bod8P' o888o o888o o888o o888o o888o o888o \`Y8bod8P'      "888" \`Y8bod8P' d888b    o888o o888o o888o o888o o888o o888o \`Y888""8o o888o
\nType help for more information, and to clear this greeting.`
let greeting =` _    _ ____ __   ___ _____ __  __ ____    ____ _____    __  __ _  _    _____ _  _ __   ____ _  _ ____ 
( \\/\\/ ( ___(  ) / __(  _  (  \\/  ( ___)  (_  _(  _  )  (  \\/  ( \\/ )  (  _  ( \\( (  ) (_  _( \\( ( ___)
 )    ( )__) )(_( (__ )(_)( )    ( )__)     )(  )(_)(    )    ( \\  /    )(_)( )  ( )(__ _)(_ )  ( )__) 
(__/\\__(____(____\\___(_____(_/\\/\\_(____)   (__)(_____)  (_/\\/\\_)(__)   (_____(_)\\_(____(____(_)\\_(____)
 ____ ____ ____ __  __ ____ _  _   __   __                                                             
(_  _( ___(  _ (  \\/  (_  _( \\( ) /__\\ (  )                                                            
  )(  )__) )   /)    ( _)(_ )  ( /(__)\\ )(__                                                           
 (__)(____(_)\\_(_/\\/\\_(____(_)\\_(__)(__(____)                                                          `
console.log(greeting)

function getCookie(cname) {
    var name = cname + "=";
    var decodedCookie = decodeURIComponent(document.cookie);
    var ca = decodedCookie.split(';');
    for(var i = 0; i <ca.length; i++) {
      var c = ca[i];
      while (c.charAt(0) == ' ') {
        c = c.substring(1);
      }
      if (c.indexOf(name) == 0) {
        return c.substring(name.length, c.length);
      }
    }
    return "";
}

let loc = 'home'
let fileLocs = {
    '/': ['home'],
    'home':[]
}
let files = {
    '/':{'home':'folder'},
    'home':{
    'info.txt': 'Made with JQuery Terminal',
    'about.txt': 'Made by Chase Horton 4/25/21',
    'fizzBuzz.py': 'while True:\n   print("fizzBuzz")'
    }
}
let repo = {}
let term = $('#terminalDiv').terminal({
    help : function(cmd){
        if(x != undefined){
            this.clear()
            x = undefined;
        }
        if(cmd == undefined){
        this.echo(`For more information on any command press type help COMMAND-NAME
clear   or    CTRL + L  |   Clears the screen
help COMMAND            |   Returns more information on the command
ls                      |   Lists files in current directory
cat FILENAME            |   Prints contents of FILENAME
touch FILENAME 'CONTENT'|   Create File with FILENAME containing CONTENT (note: content of the file must be in single or double quotes)
rm FILENAME             |   Deletes FILENAME
cd LOCATION             |   Change current directory to LOCATION
mkdir DIR               |   Create a directory with name DIR
git init DIR            |   Commit DIR to local repository
git status              |   Displays changes in files compared to local and online repository
git commit              |   Updates local repository with changes
git checkout            |   Checkout online repository, loads online repository into local repository
git pull                |   Updates files with content of local repository
git push                |   Pushes Commits on local repository to online repository
git restore             |   Restore filesystem to last commit on local repository`
);} else if(cmd == 'git'){
    this.echo(`\nIf you are new to git running "git tutorial" will give a more detailed explanation of how to get started using git

"git init": initializes a local repository in the directory specified. If you're new to git, think of a local repository as an area where you can store your files everytime 
you make an important change, and then later after editing the file you are able to return to these changes, view previous versions of the file, or update your repository
 with your new changes.

"git status": displays all changes made to the local repository compared to the online repository, and below that display all changes made to the directory within your 
filesystem compared to the files in the local repository.

"git checkout": pulls the files from your online repository, and updates the data of your local repository, can be followed by "git restore" to update filesystem with new files
but it's simpler to simply use git pull.

"git commit": commit changes in filesystem to local repository

"git pull": similar to git checkout but updates local repository and filesystem

"git push": update online repository with contents of local repository

"git restore": restore filesystem to last commit on local repository`)
}
    },
    ls : function(){
        if(loc == undefined){
            let keys = Object.keys(files)
            for(let i = 0; i < keys.length; i++){
                this.echo(keys[i]);
            }
        } else {
            let keys = Object.keys(files[loc])
            for(let i = 0; i < keys.length; i++){
            this.echo(keys[i]);
            }
        }
        
    },
    cat : function(fileName){
        if(files[loc][fileName] == undefined){
            this.echo('Invalid File Name.')
        } else{
            this.echo(files[loc][fileName]);
        }

    },
    touch : function(fileName, fileContent){
        if(files[loc][fileName] == undefined){
            files[loc][fileName] = fileContent;
        }
        else{
            this.echo('File already exists');
        }
    },
    rm : function(fileName){
        delete files[loc][fileName];
    },
    mkdir : function(dirName){
        if(!fileLocs[loc].includes(dirName)){
            files[dirName] = {};
            files[loc][dirName] = 'folder'
            fileLocs[loc].push(dirName);
        } else{
            this.echo('Cannot create a directory that already exists.')
        }
    },
    cd : function(dirName){
        if(dirName == '..'){
            temp = Object.keys(fileLocs).find(key => fileLocs[key].includes(loc));
            if(temp != undefined){
                loc = temp;
            } else{
                this.echo('You are already at the root directory!')
            }
        }
        else if(fileLocs[loc].includes(dirName)){
            loc = dirName;
        }
        else{
            this.echo('Directory does not exist');
        }
    },
    git : function(option, filename){
        if(option == 'init'){
            if(files[filename]!= undefined){
                repo[filename] = files[filename]
                document.cookie = "savedData=" + JSON.stringify(repo)+";";
                this.echo('Commited ' + filename + ' to your local repository and pushed initial commit to online repository.');
            } else{
                this.echo('Invalid file name.');
            }
        } else if(option == 'remove'){
            if(repo[filename] != undefined){
                delete repo[filename];
                this.echo('Removed ' + filename + ' from your local repository');
            } else{
                this.echo(filename + ' not found in your local repository, type "git status" to view your local repository');
            }  
        } else if(option == 'push'){
            document.cookie = "savedData=" + JSON.stringify(repo)+";";
            this.echo('Pushing added files into cookies :)');
        } else if(option == 'status'){
            if(Object.keys(repo).length != 0){
                //can easily make recursive function that goes into folders by checking if folder in string and fileLocs but for now only prints folders
                this.echo('\nChanges to be pushed:')//add to different branches CHANGE THIS TO DISPLAY THE DIFF BETWEEN COOKIE AND REPO AND ALSO DIFF BETWEEN REPO AND FILES
                let cookie = JSON.parse(getCookie("savedData"));
                let allFiles = {};
                let mods = false;
                for(const folder in repo){
                    Object.assign(allFiles, JSON.parse(JSON.stringify(repo[folder])), JSON.parse(JSON.stringify(cookie[folder])));
                }
                for(const folder in repo){
                    this.echo(`-${folder}`);
                    for(const file in allFiles){
                        if(repo[folder][file] == cookie[folder][file]){
                            //this.echo(` --${file}`);
                        } else if(cookie[folder][file] == undefined){
                            this.echo(` --${file} (added)`);
                            mods = true;
                        } else if(repo[folder][file] == undefined){
                            this.echo(` --${file} (removed)`);
                            mods = true;
                        } else if(repo[folder][file] != cookie[folder][file]){
                            this.echo(` --${file} (modified)`);
                            mods = true;
                        }
                    }
                    if(!mods){
                        this.echo(` --Up to Date`);
                    }
                }
                this.echo('\nDifferences beween repository and files (changes to be commited)');
                allFiles = {};
                mods = false;
                for(const folder in repo){
                    Object.assign(allFiles, JSON.parse(JSON.stringify(files[folder])), JSON.parse(JSON.stringify(repo[folder])));
                }
                for(const folder in repo){
                    this.echo(`-${folder}`)
                    for(const file in allFiles){
                        if(repo[folder][file] == files[folder][file]){
                            //this.echo(` --${file}`);
                        } else if(repo[folder][file] == undefined){
                            this.echo(` --${file} (added)`);
                            mods = true;
                        } else if(files[folder][file] == undefined){
                            this.echo(` --${file} (removed)`);
                            mods = true;
                        } else if(repo[folder][file] != files[folder][file]){
                            this.echo(` --${file} (modified)`);
                            mods = true;
                        }
                    }
                    if(!mods){
                        this.echo(` --Up to Date`);
                    }
                    this.echo('')
                }
            } else{
                this.echo('No local repository found, run git checkout to checkout a repository, or type help git for more information on git.');
            }
        } else if(option == 'pull'){
            repo = JSON.parse(getCookie("savedData"));
            if(Object.keys(repo).length > 0){
                console.log(repo)
                for(const folder in repo){
                    this.echo('Checked out: ' + folder);
                }
                for(const folder in repo){
                    files[folder] = $.extend(true,{},repo[folder]);
                    this.echo('Updated folder: ' + folder)
                }
            }
        } else if(option == 'commit'){
            let allFiles = {};
            let mods = false;
            for(const folder in repo){
                Object.assign(allFiles, JSON.parse(JSON.stringify(files[folder])), JSON.parse(JSON.stringify(repo[folder])));
            }
            for(const folder in repo){
                this.echo(`Commited changes to ${folder}`)
                for(const file in allFiles){
                    if(repo[folder][file] == files[folder][file]){
                        //this.echo(` --${file}`);
                    } else if(repo[folder][file] == undefined){
                        this.echo(` --${file} (added)`);
                        mods = true;
                    } else if(files[folder][file] == undefined){
                        this.echo(` --${file} (removed)`);
                        mods = true;
                    } else if(repo[folder][file] != files[folder][file]){
                        this.echo(` --${file} (modified)`);
                        mods = true;
                    }
                }
                if(!mods){
                    this.echo(` --Already up to Date`);
                }
                this.echo('')
            }
            for(const folder in repo){
                repo[folder] = JSON.parse(JSON.stringify(files[folder]));
            }
            console.log(repo)
        } else if(option == 'restore'){
            for(const folder in repo){
                files[folder] = JSON.parse(JSON.stringify(repo[folder]));
                this.echo('Restored directory to last commit');
            }
        } else if(option == 'checkout'){
            repo = JSON.parse(getCookie("savedData"));
            if(Object.keys(repo).length > 0){
                console.log(repo)
                for(const folder in repo){
                    this.echo('Checked out: ' + folder);
                }
            } else{
                this.echo('No repository found, run "git init DIR" to initialize a repository at DIR')
            }
        } else if(option == 'tutorial'){
            this.echo(`\nThis git command works similarly, but a bit different than the actual git command because github pages is limited to only static websites,
therefore all user data is stored in cookies which are limited to 4096 bytes. Because of this git simply acts as a way to save files rather than storing 
detailed file history as well.

The command "git init" initializes a local repository in the directory specified. If you're new to git, think of a local repository as
an area where you can store your files everytime you make an important change, and then later after editing the file you are able to return to these changes,
view previous versions of the file, or update your repository with your new changes.

After you've initialized your repository, and change some files inside of the directory, you may want to run "git status", which will display all changes made to 
the local repository compared to the online repository, and below that display all changes made to the directory within your filesystem compared to the files 
in the local repository.

If you want to update your local repository with the data stored within your filesystem you just need
to type "git commit", and this will update your local repository with all changes made within the directory.

Now that you know how to store data in your local repository, you are able to push this data to the online repository using "git push",
    where it may be checked out later using "git checkout" or "git pull" after closing or refreshing the browser

"git checkout" pulls the files from your online repository, and updates the data of your local repository, can be followed by "git restore" to update 
filesystem with new files but it's simpler to simply use git pull.

"git pull" functions similar to git checkout but updates local repository and filesystem

"git restore" restores filesystem to last commit on local repository\n`);
        } else{
            this.echo(option + ' is not a valid argument. Type "help git" for more information on git or "git tutorial" for a quick start guide on git.');
        }
    }
    }, 
    {
        greetings: greeting + '\n\n Type "help" for more information, and to clear the screen.\n' /*x, 'Welcome to my online terminal. Type help for more information...'*/,
        completion: true,
        checkArity: false,
    }
);

//BUTTONS
document.getElementById('help-button').onclick = showHelp;
function showHelp(){
    console.log('help');
    term.exec('help');
}